<head>
  <title>Template-Level Subscriptions</title>
</head>

<body>
  <div class="posts">
    {{> posts}}
  </div>
</body>

<template name="posts">
  {{#with posts}}
    {{#each cursor}}
      <div class="post">
        <h3>{{title}} - {{_id}}</h3>
        <p>{{body}}</p>
        {{> comments postId=_id postTitle=title}}
      </div>
    {{/each}}
    {{#if isReady}}
      <a class="load-more load-more-posts" href="#">Load More Posts</a>
    {{else}}
      <div class="loading">{{>spinner}}</div>
    {{/if}}
  {{/with}}
</template>

<template name="comments">
  {{#with comments}}
    <h4>Showing {{count}}/{{totalCount}} comments </h4>
    <ul>
      {{#each cursor}}
        <li><strong>{{_id}}</strong> {{body}}</li>
      {{/each}}
      {{#if isReady}}
        <a class="load-more load-more-comments" href="#">Load More Comments</a>
      {{else}}
        <div class="loading">{{>spinner}}</div>
      {{/if}}
    </ul>  
  {{/with}}
</template>